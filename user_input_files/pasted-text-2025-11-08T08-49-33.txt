# Organigrama y Equipos HAAS — v1 (multi‑agente, multi‑tenant)

**Autor:** GPT‑5 Thinking para AHFB
**Fecha:** 08‑Nov‑2025 (America/Lima)

> Objetivo: Definir, estructurar y estandarizar **todos los equipos** de la plataforma HAAS + MCP (multi‑tenant), incluyendo diseño y desarrollo, planeación, investigación, soporte/auto‑reparación, supervisión/PMO, gestión de contexto (analizadores/organizadores/auditores), orquestación/comunicación con usuario, notificaciones, limpieza/higiene, mejora continua e innovación, seguridad/compliance, SRE/infra, MCP/tools, RAG/conocimiento y UX/UI. Cada equipo incluye **propósito, responsabilidades, interfaces, artefactos `.md`, KPIs, SLAs, rituales**, y **protocolos de escalación**.

---

## 1) Visión de alto nivel

```mermaid
flowchart TD
  ORQ[Orquestador (cara al usuario)]
  PLAN[Equipo de Planeación]
  RES[Equipo de Investigación]
  DEV[Equipo de Diseño & Desarrollo]
  CTX[Equipo Gestión de Contexto (Analizadores/Organizadores/Auditores)]
  SUP[Equipo Soporte/Auto‑Reparación]
  NOTI[Equipo Notificaciones & Comunicación]
  PMO[Equipo Supervisión/PMO]
  HIG[Equipo Limpieza & Higiene (Datos/Code/RAG)]
  IMP[Equipo Mejora Continua & Innovación]
  SEC[Equipo Seguridad & Compliance]
  SRE[SRE & Plataformas]
  MCP[MCP & Catálogo de Tools]
  RAG[RAG & Conocimiento]
  UX[Equipo UX/UI]

  ORQ-->PLAN
  PLAN<-->RES
  PLAN-->DEV
  DEV-->CTX
  CTX-->PMO
  SUP-->NOTI
  CTX-->NOTI
  PMO-->NOTI
  SEC-->PMO
  SRE-->PMO
  MCP-->DEV
  RAG-->DEV
  UX-->DEV
  ORQ-->NOTI
```

---

## 2) RACI global por macro‑función

| Macro‑función               | R (Responsable) | A (Accountable) | C (Consultado)            | I (Informado)     |
| --------------------------- | --------------- | --------------- | ------------------------- | ----------------- |
| Intención/Brief             | Orquestador     | PMO             | Planeación, Investigación | Notificaciones    |
| Planificación (DAG)         | Planeación      | PMO             | Investigación, DEV, CTX   | Orquestador       |
| Ejecución Técnica           | DEV             | PMO             | UX, MCP, RAG, SEC, SRE    | CTX, NOTI         |
| Gestión Contexto/Artefactos | CTX             | PMO             | DEV, Planeación           | Orquestador, NOTI |
| Auto‑reparación             | Soporte         | PMO             | CTX, DEV, SEC             | NOTI              |
| Notificaciones              | Notificaciones  | PMO             | CTX, Soporte, Orq.        | Todos             |
| Higiene/Limpieza            | Higiene         | PMO             | CTX, RAG, DEV             | SRE               |
| Mejora/Innovación           | Mejora          | PMO             | Todos                     | Todos             |
| Seguridad/Compliance        | Seguridad       | PMO             | SRE, CTX                  | Todos             |
| SRE/Infra/Observabilidad    | SRE             | PMO             | Seguridad                 | Todos             |
| MCP/Tools                   | MCP             | PMO             | Seguridad, DEV            | CTX               |
| RAG/Conocimiento            | RAG             | PMO             | CTX, DEV, Higiene         | Orq.              |
| UX/UI                       | UX              | PMO             | DEV, Orq.                 | Todos             |

---

## 3) Definición detallada de equipos

Cada ficha incluye: **Propósito • Responsabilidades • Interfaces • Artefactos `.md` • KPIs/SLA • Ritual/SOP • Escalación**

### 3.1 Orquestador (cara al usuario)

* **Propósito:** Ser la interfaz inteligente con el usuario; detectar intención, mantener conversación asíncrona y estado; enrutar dudas y confirmar hitos.
* **Responsabilidades:** Intent detection, sesión multi‑tenant, lectura segura de estado, resúmenes de progreso, recibo de aprobaciones.
* **Interfaces:** REST/gRPC (DetectIntent, GetStatus), NOTI, PLAN, CTX.
* **Artefactos:** `brief.md`, `user_decisions.md`.
* **KPIs:** TTI (Time‑to‑Intent), satisfacción (CSAT), tasa de aclaración resuelta.
* **Ritual:** Standup de prioridades con PLAN (2×/día); cierre diario con PMO.
* **Escalación:** Ambigüedad alta → Investigación; conflicto de alcance → PMO.

### 3.2 Equipo de Planeación

* **Propósito:** Convertir brief en **DAG ejecutable** con contratos I/O, dependencias, due dates y tareas de artefacto.
* **Responsabilidades:** Descomposición, ordenación topológica, *critical path*, definición de **locks** y recursos.
* **Interfaces:** Orquestador, Investigación, DEV, CTX, NOTI.
* **Artefactos:** `plan.md`, `dag.json`, `risk_register.md`.
* **KPIs:** % tareas “ready” sin bloqueos, predictibilidad (varianza de lead time), calidad de contratos.
* **Ritual:** `Pre‑Plan Review` con Investigación; `Plan Playback` con DEV/CTX.
* **Escalación:** Dependencia imposible → PMO/Orq.; riesgos críticos → Noti + SEC.

### 3.3 Equipo de Investigación

* **Propósito:** Reducir incertidumbre técnica/negocio; aportar *grounding* y benchmarks.
* **Responsabilidades:** RFI, *competitive scans*, POCs, *evidence packs*.
* **Interfaces:** Planificación (siempre previa), DEV, RAG.
* **Artefactos:** `research_pack.md`, `sources.md`, `benchmarks.md`.
* **KPIs:** Tiempo a respuesta RFI, cobertura de riesgos (≥90%), calidad de fuentes.
* **Ritual:** `Research Sprint 48h` por objetivo; co‑diseño con Planeación.
* **Escalación:** Hallazgos bloqueantes → Replan con PMO.

### 3.4 Equipo de Diseño & Desarrollo (DEV)

* **Propósito:** Implementar artefactos técnicos y de producto con calidad de producción.
* **Responsabilidades:** Arquitectura, backend, frontend, DevEx, QA técnico, documentación.
* **Interfaces:** MCP, RAG, CTX, UX, SEC, SRE.
* **Artefactos:** `tech_spec.md`, `impl_notes.md`, `test_report.md`.
* **KPIs:** DORA (lead time, deploy freq, MTTR, change fail %), cobertura tests, defect density.
* **Ritual:** Code reviews, `Tech Design Review`, `Release Train` semanal.
* **Escalación:** Bloqueos de recursos → CTX (lock); defectos críticos → Soporte.

### 3.5 Equipo Gestión de Contexto (CTX: Analizadores/Organizadores/Auditores)

* **Propósito:** Ser **único escritor de estado derivado** (CQRS): valida `.md`, materializa read models, gestiona locks y coherencia.
* **Responsabilidades:** Validación de esquema, hash‑chain, actualización de `tasks_read`, `task_edges`, `artifacts_read`, `resource_locks`.
* **Interfaces:** DEV, PLAN, NOTI, PMO.
* **Artefactos:** `audit_report.md`, `context_health.md`.
* **KPIs:** % artefactos válidos, latencia de proyección, incidencias `AuditFailed`.
* **Ritual:** Auditoría continua + `Context Sync` diario con PMO.
* **Escalación:** Inconsistencias → `AuditFailed` → Soporte/PMO.

### 3.6 Equipo Soporte / Auto‑Reparación

* **Propósito:** Sistema inmunológico: triage, RCA, parchado en sandbox, verificación y re‑planeación.
* **Responsabilidades:** QA proactivo (tests automáticos), triage reactivo, RCA asistido por LLM, parches, coordinación de replan.
* **Interfaces:** CTX (evidencias), DEV (parches), NOTI (alertas), PMO.
* **Artefactos:** `incident.md`, `rca.md`, `patch_notes.md`.
* **KPIs:** MTTR, % auto‑fix exitoso, reincidencia.
* **Ritual:** `Incident Review` 2×/semana; `GameDays` mensuales.
* **Escalación:** Falla persistente → ReplanRequired (PLAN/PMO).

### 3.7 Equipo Notificaciones & Comunicación

* **Propósito:** Hub and Spoke de eventos; notificación **dirigida por dependencias** (no broadcast).
* **Responsabilidades:** Enrutamiento con performativos, SLA de entrega, canales (SSE, Webhook, Slack/Email).
* **Interfaces:** CTX (quién afecta), Soporte, PMO, Orq.
* **Artefactos:** `comm_matrix.md`, `notification_policies.md`.
* **KPIs:** Entregas dentro de SLA, tasa de ruido (alertes ignoradas), latencia de propagación.
* **Ritual:** `Signal/Noise Review` semanal.
* **Escalación:** Tormenta de eventos → rate‑limit y agregación con PMO.

### 3.8 Equipo Supervisión / PMO

* **Propósito:** Gobernanza, priorización, cumplimiento, riesgos, value delivery.
* **Responsabilidades:** OKRs, roadmap, auditoría de SLA/KPI, alineación multi‑tenant.
* **Interfaces:** Todos los equipos.
* **Artefactos:** `pmo_status.md`, `okr.md`, `risk_register.md`.
* **KPIs:** Cumplimiento de hitos, desviación de scope, riesgo residual.
* **Ritual:** `SteerCo` semanal con líderes.
* **Escalación:** Conflictos de prioridad → decisión ejecutiva.

### 3.9 Equipo Limpieza & Higiene (Datos/Code/RAG)

* **Propósito:** Mantener **calidad y orden** en código, datos y conocimiento.
* **Responsabilidades:** Linters/formatters, de‑dupe RAG, rotación de embeddings, vencimiento de artefactos.
* **Interfaces:** RAG, DEV, CTX.
* **Artefactos:** `hygiene_report.md`, `retention_policy.md`.
* **KPIs:** deuda técnica, duplicados RAG, drift embeddings.
* **Ritual:** `Hygiene Friday` quincenal.
* **Escalación:** Hallazgos críticos → PMO/DEV.

### 3.10 Equipo Mejora Continua & Innovación

* **Propósito:** Proactividad sistemática: experimentar, medir y escalar mejoras.
* **Responsabilidades:** A/B de prompts, *model routing*, *tooling* nuevo, automatizaciones.
* **Interfaces:** Orq., DEV, MCP, RAG.
* **Artefactos:** `improvement_proposal.md`, `experiment_results.md`.
* **KPIs:** ganancias de productividad, reducción de fallas, N mejoras/mes.
* **Ritual:** `Kaizen Board` continuo.
* **Escalación:** Innovación disruptiva → *feature flag* + PMO.

### 3.11 Seguridad & Compliance

* **Propósito:** Protección de datos, cumplimiento y *guardrails*.
* **Responsabilidades:** RLS, secretos, mTLS, DLP, revisión de tools MCP, auditorías.
* **Interfaces:** PMO, MCP, CTX, SRE.
* **Artefactos:** `security_baseline.md`, `threat_model.md`.
* **KPIs:** incidentes de seguridad, hallazgos sin cerrar, tiempo de parcheo.
* **Ritual:** `Security Guild` semanal.
* **Escalación:** Violación → contención + reporte PMO.

### 3.12 SRE & Plataformas

* **Propósito:** Confiabilidad, rendimiento y costos.
* **Responsabilidades:** Infra, monitoreo, capacidad, backups/DR, `docker-compose`, hardening.
* **Interfaces:** DEV, SEC, PMO.
* **Artefactos:** `runbook/*.md`, `capacity_plan.md`.
* **KPIs:** SLO/SLA, error budget, eficiencia costos.
* **Ritual:** *Error budget review* mensual.
* **Escalación:** Brecha SLO → congelar despliegues.

### 3.13 MCP & Catálogo de Tools

* **Propósito:** Proveer herramientas seguras con políticas por tenant/perfil.
* **Responsabilidades:** *InitializeSession*, scopes, quotas, rate‑limits, sandbox.
* **Interfaces:** DEV, SEC, CTX.
* **Artefactos:** `tool_catalog.md`, `policy_tools.yaml`.
* **KPIs:** éxito de invocación, latencia, fallas por límite.
* **Ritual:** Revisión mensual de catálogo.
* **Escalación:** Tool inestable → *circuit breaker*.

### 3.14 RAG & Conocimiento

* **Propósito:** Recuperación semántica por tenant/proyecto con calidad y trazabilidad.
* **Responsabilidades:** Colecciones `pgvector`, ingestión, chunking, re‑rank, evaluación.
* **Interfaces:** CTX, DEV, Higiene.
* **Artefactos:** `rag_collection.md`, `ingestion_report.md`.
* **KPIs:** precisión@k, cobertura, frescura.
* **Ritual:** Evaluación mensual con *golden sets*.
* **Escalación:** Drift severo → re‑index + Higiene.

### 3.15 UX/UI

* **Propósito:** Experiencias claras, accesibles y consistentes.
* **Responsabilidades:** Design system, flows, prototipos, handoff a DEV.
* **Interfaces:** Orq., PMO, DEV.
* **Artefactos:** `ux_spec.md`, `design_tokens.json`.
* **KPIs:** tasa de éxito de tareas, tiempo de navegación, NPS.
* **Ritual:** `Design Crit` semanal.
* **Escalación:** Fricción alta → priorización con PMO.

---

## 4) Protocolos operativos comunes

* **Comunicación estándar:** Envelope JSON + resumen NL (performativos: REQUEST, INFORM, HALT, ERROR, ACK).
* **Artefactos `.md` obligatorios:** front‑matter con `tenant_id`, `project_id`, `task_id`, `hash_prev/hash_curr`, `schema_version`.
* **Locks:** `LockResourceRequest` → CTX decide (único escritor) → `LockGranted/Denied`.
* **Notificación dirigida:** consulta de dependencias (CTE) para receptores.
* **Escalación:** P0 (inmediata a PMO + SEC + NOTI), P1 (Soporte), P2 (DEV), P3 (backlog).

---

## 5) Plantillas `.md` por equipo (extracto)

**`incident.md`** (Soporte)

```markdown
---
severity: P1
service: planner
tenant_id: t-...
project_id: p-...
related_tasks: [T-123]
---
# Resumen
# Timeline
# RCA
# Fix / Validación
# Acciones preventivas
```

**`audit_report.md`** (CTX)

```markdown
---
artifact_type: audit
scope: plan|task|artifact
result: pass|fail
findings: []
---
# Evidencia
# Recomendaciones
```

**`research_pack.md`** (Investigación)

```markdown
---
question: "..."
method: desk|experiments
sources: []
confidence: high|med|low
---
# Hallazgos
# Implicaciones
# Recomendaciones
```

**`improvement_proposal.md`** (Mejora)

```markdown
---
hypothesis: "..."
metric: latency|quality|cost
expected_gain: "10%"
rollout: flag|canary
---
# Diseño del experimento
# Resultados esperados
```

---

## 6) Hitos de conformación de equipos

1. **Nombramientos** de líderes por equipo (A: accountable).
2. **OKRs** y **charters** por equipo.
3. **Backlogs** iniciales y tableros.
4. **Checklists** de ingreso (acceso, playbooks, políticas).
5. **Acuerdos de interfaz** (inputs/outputs, SLAs entre equipos).

---

## 7) KPIs y SLAs transversales

* **Flujo**: tiempo intención→plan; plan→tarea ready; tarea→artefacto válido; MTTR.
* **Calidad**: tasa `AuditFailed`, defect density, precisión RAG.
* **Confiabilidad**: SLO por API/worker; backlog colas; locks retenidos.
* **Seguridad**: incidentes, hallazgos; cumplimiento RLS.
* **Producto**: N mejoras/mes; satisfacción usuario.

---

## 8) Roadmap de activación (30 días)

* **Semana 1:** PMO, Orq., Planeación, Investigación, CTX.
* **Semana 2:** DEV, UX, MCP, RAG.
* **Semana 3:** Soporte, Noti, Higiene, SRE.
* **Semana 4:** Seguridad, Mejora, cierres OKR, pruebas E2E.

---

## 9) Matriz de interfaces (resumen)

| Emisor  | Receptor | Input                 | Output            | SLA      |
| ------- | -------- | --------------------- | ----------------- | -------- |
| Orq.    | Plan     | intención             | `brief.md`        | TTI ≤ 5m |
| Plan    | DEV      | `plan.md`, `dag.json` | `tech_spec.md`    | 24–48h   |
| DEV     | CTX      | `artifact.md`         | `audit_report.md` | ≤ 10m    |
| CTX     | Noti     | `AuditFailed`         | `HALT` dirigido   | ≤ 60s    |
| Soporte | Plan     | `rca.md`              | `ReplanRequired`  | ≤ 30m    |

---

> **Siguiente paso sugerido:** nombrar líderes, aprobar charters y cargar estas plantillas a tu repos `haas-playbooks/` por carpetas de equipo. Puedo generar los **charters y OKRs iniciales** de cada equipo ya mismo.
